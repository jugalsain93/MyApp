import{a as te}from"./chunk-F2CZZAQT.js";import{a as A}from"./chunk-MCTHUXQ3.js";import{a as j,b as x,c as G,d as K,g as H,h as q,i as z,j as Y,k as J,l as X,m as Z,n as Q,o as W,p as ee}from"./chunk-IVHO64GE.js";import"./chunk-YLB4LM2T.js";import{c as T,d as L,f as $,h as P,r as U}from"./chunk-UTQS25EZ.js";import{$a as R,Aa as F,Fa as b,N as M,Pa as c,Qa as i,R as N,Ra as t,Sa as d,Ta as w,Ua as k,Va as h,Wa as f,X as v,Xa as s,Y as g,bb as n,cb as p,db as _,eb as y,l as B,mb as V,p as u,ra as a,wa as E,xb as O}from"./chunk-LAEVRNZJ.js";var C=U.apiBaseUrl;var I=class r{constructor(o){this.http=o}getTicketingPartners(){return this.http.get(`${C}/Membership/TicketingPartnerList/Business`)}submitMembership(o){return this.http.post(`${C}/Membership/BlockRadianceMembership/Registration`,o)}getMembershipList(o,e,l){return this.http.get(`${C}/Membership/BlockRadianceMembership/List/${o}?pageNumber=${e}&pageSize=${l}`)}getMembershipDetails(o){return this.http.get(`${C}/Membership/GetByMembership/${o}`)}downloadMembershipExcel(o){let e=`MembershipId,Company,Plan
123,Acme Corp,Gold
456,XYZ Inc,Silver`,l=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});return B(l)}static \u0275fac=function(e){return new(e||r)(N(P))};static \u0275prov=M({token:r,factory:r.\u0275fac,providedIn:"root"})};function oe(r,o){if(r&1&&(w(0),d(1,"input",29),k()),r&2){let e=s(2);a(),c("value",e.profile.regionName)}}function re(r,o){if(r&1&&(i(0,"option",33),n(1),t()),r&2){let e=o.$implicit;c("value",e.id),a(),p(e.name)}}function ae(r,o){if(r&1){let e=h();i(0,"select",30),f("change",function(){v(e);let m=s(2);return g(m.onRegionChange())}),i(1,"option",31),n(2,"All"),t(),b(3,re,2,2,"option",32),t()}if(r&2){let e=s(2);a(3),c("ngForOf",e.regionKeyValues)}}function le(r,o){if(r&1&&(w(0),d(1,"input",29),k()),r&2){let e=s(2);a(),c("value",e.profile.countryName)}}function me(r,o){if(r&1&&(i(0,"option",33),n(1),t()),r&2){let e=o.$implicit;c("value",e.id),a(),p(e.name)}}function ce(r,o){if(r&1&&(i(0,"select",34)(1,"option",31),n(2,"All"),t(),b(3,me,2,2,"option",32),t()),r&2){let e=s(2);a(3),c("ngForOf",e.countryList)}}function se(r,o){if(r&1){let e=h();i(0,"form",9),f("ngSubmit",function(){v(e);let m=s();return g(m.onFilterSubmit())}),i(1,"div",10)(2,"label"),n(3,"Region Name"),t(),b(4,oe,2,1,"ng-container",11)(5,ae,4,1,"ng-template",null,0,V),t(),i(7,"div",10)(8,"label"),n(9,"Country Name"),t(),b(10,le,2,1,"ng-container",11)(11,ce,4,1,"ng-template",null,1,V),t(),i(13,"div",10)(14,"label"),n(15,"Business Partner"),t(),d(16,"input",12),t(),i(17,"div",10)(18,"label"),n(19,"Membership Id"),t(),d(20,"input",13),t(),i(21,"div",10)(22,"label"),n(23,"Status"),t(),i(24,"select",14)(25,"option",15),n(26,"Select"),t(),i(27,"option",16),n(28,"Pending"),t(),i(29,"option",17),n(30,"Form-Submitted"),t(),i(31,"option",18),n(32,"Active"),t(),i(33,"option",19),n(34,"De-Activated"),t()()(),i(35,"div",10)(36,"label"),n(37,"Reference Source"),t(),d(38,"input",20),t(),i(39,"div",21)(40,"label"),n(41,"Date Range"),t(),i(42,"div",22),d(43,"input",23),i(44,"span",24),n(45,"to"),t(),d(46,"input",25),t()(),i(47,"div",26)(48,"button",27),n(49,"Search"),t(),i(50,"button",28),f("click",function(){v(e);let m=s();return g(m.DownloadExcelFile())}),n(51,"Download"),t()()()}if(r&2){let e=R(6),l=R(12),m=s();c("formGroup",m.filterForm),a(4),c("ngIf",m.profile.userLevelId>1)("ngIfElse",e),a(6),c("ngIf",m.profile.userLevelId>2)("ngIfElse",l)}}function de(r,o){if(r&1){let e=h();i(0,"tr")(1,"td"),n(2),t(),i(3,"td"),n(4),t(),i(5,"td"),n(6),t(),i(7,"td"),n(8),t(),i(9,"td"),n(10),t(),i(11,"td"),n(12),t(),i(13,"td"),n(14),t(),i(15,"td",37),n(16),t(),i(17,"td"),n(18),t(),i(19,"td")(20,"button",38),f("click",function(){let m=v(e).$implicit,S=s(2);return g(S.setMode("view",m.id))}),n(21,"View"),t()()()}if(r&2){let e=o.$implicit;a(2),p(e.membershipId),a(2),p(e.companyName),a(2),y("",e.duration," ",e.durationUnit),a(2),p(e.subscriptionType),a(2),p(e.source),a(2),p(e.membershipDate),a(2),p(e.membershipExpiryDate),a(2),y("",e.transactionAmount," ",e.currency),a(2),p(e.status)}}function pe(r,o){if(r&1&&(i(0,"div")(1,"table",35)(2,"thead")(3,"tr")(4,"th"),n(5,"MembershipId"),t(),i(6,"th"),n(7,"Company"),t(),i(8,"th"),n(9,"Duration"),t(),i(10,"th"),n(11,"Plan"),t(),i(12,"th"),n(13,"Source"),t(),i(14,"th"),n(15,"MEM Date"),t(),i(16,"th"),n(17,"Exp Date"),t(),i(18,"th"),n(19,"Amount"),t(),i(20,"th"),n(21,"Status"),t(),i(22,"th"),n(23,"Action"),t()()(),i(24,"tbody"),b(25,de,22,11,"tr",36),t()()()),r&2){let e=s();a(25),c("ngForOf",e.listItem)}}function ue(r,o){if(r&1&&(i(0,"option",33),n(1),t()),r&2){let e=o.$implicit;c("value",e.id),a(),p(e.name)}}function fe(r,o){if(r&1&&(i(0,"option",33),n(1),t()),r&2){let e=o.$implicit;c("value",e.id),a(),p(e.name)}}function be(r,o){if(r&1&&(i(0,"option",33),n(1),t()),r&2){let e=o.$implicit;c("value",e.id),a(),p(e.name)}}function ve(r,o){if(r&1){let e=h();i(0,"form",39),f("ngSubmit",function(){v(e);let m=s();return g(m.onSubmit())}),i(1,"div",40)(2,"div",41),n(3,"BlockRadiance Membership Registration"),t(),i(4,"div",42)(5,"div",43)(6,"div",10)(7,"label"),n(8,"Country"),t(),i(9,"select",44),f("change",function(m){v(e);let S=s();return g(S.onCountryChange(m))}),b(10,ue,2,2,"option",32),t()(),i(11,"div",10)(12,"label"),n(13,"Subscription Type"),t(),i(14,"select",45),f("change",function(m){v(e);let S=s();return g(S.onSubscriptionChange(m))}),i(15,"option",15),n(16,"Select"),t(),b(17,fe,2,2,"option",32),t()(),i(18,"div",10)(19,"label"),n(20,"Business Partner"),t(),i(21,"select",46),b(22,be,2,2,"option",32),t()(),i(23,"div",47)(24,"label"),n(25,"Duration Unit"),t(),d(26,"input",48),t(),i(27,"div",49)(28,"label"),n(29,"Duration"),t(),d(30,"input",50),t(),i(31,"div",51)(32,"label"),n(33,"Email Ids"),t(),d(34,"textarea",52),t(),i(35,"div",51)(36,"label"),n(37,"Email Subject"),t(),d(38,"input",53),t(),i(39,"div",51)(40,"label"),n(41,"Email Body"),t(),d(42,"textarea",54),t()(),i(43,"div",55)(44,"button",56),n(45,"Submit"),t()()()()()}if(r&2){let e=s();c("formGroup",e.form),a(10),c("ngForOf",e.countryList),a(7),c("ngForOf",e.subscriptionList),a(5),c("ngForOf",e.partnerList),a(22),c("disabled",e.form.invalid)}}function ge(r,o){if(r&1){let e=h();i(0,"div",40)(1,"div",57)(2,"span"),n(3,"Membership Details"),t(),i(4,"button",58),f("click",function(){v(e);let m=s();return g(m.setMode("list"))}),n(5,"Back"),t()(),i(6,"div",59)(7,"div",10)(8,"strong"),n(9,"Membership ID:"),t(),n(10),t(),i(11,"div",10)(12,"strong"),n(13,"Plan:"),t(),n(14),t(),i(15,"div",10)(16,"strong"),n(17,"Duration:"),t(),n(18),t(),i(19,"div",10)(20,"strong"),n(21,"Status:"),t(),n(22),t(),i(23,"div",60)(24,"strong"),n(25,"Company:"),t(),n(26),t(),i(27,"div",60)(28,"strong"),n(29,"Email:"),t(),n(30),t(),i(31,"div",60)(32,"strong"),n(33,"Membership Date:"),t(),n(34),t(),i(35,"div",60)(36,"strong"),n(37,"Expiry Date:"),t(),n(38),t()()()}if(r&2){let e=s();a(10),_(" ",e.selectedDetails.membershipId),a(4),_(" ",e.selectedDetails.subscriptionType),a(4),y(" ",e.selectedDetails.duration," ",e.selectedDetails.durationUnit),a(4),_(" ",e.selectedDetails.status),a(4),_(" ",e.selectedDetails.companyName),a(4),_(" ",e.selectedDetails.personalEmailId),a(4),_(" ",e.selectedDetails.membershipDate),a(4),_(" ",e.selectedDetails.membershipExpiryDate)}}var D=class r{constructor(o,e,l,m){this.fb=o;this.blockRadianceService=e;this.commonService=l;this.loadingService=m;this.form=this.fb.group({countryId:[0,x.required],subscriptionId:[null,x.required],companyId:[null,x.required],durationUnit:[{value:"",disabled:!0}],duration:[{value:0,disabled:!0}],personalEmailId:["",x.required],subject:["",x.required],htmlBody:["",x.required]}),this.filterForm=this.fb.group({regionId:[0],countryId:[0],membershipId:[""],partnerCompanyName:[""],status:[""],source:[""],fromDate:[null],toDate:[null]})}form;filterForm;countryList=[];regionKeyValues=[];subscriptionList=[];partnerList=[];emailTemplate;profile;mode="list";PaginationDto;listItem=[];selectedId=null;selectedDetails=null;ngOnInit(){this.init()}async init(){try{this.profile=await u(this.commonService.getUserProfile()),this.filterForm.patchValue({regionId:this.profile.regionId,countryId:this.profile.countryId}),this.regionKeyValues=await u(this.commonService.getRegions()),this.profile.userLevelId>1&&this.profile.regionId?this.countryList=await u(this.commonService.getCountries(this.profile.regionId)):this.countryList=await u(this.commonService.getCountriesAll()),this.partnerList=await u(this.blockRadianceService.getTicketingPartners()),this.emailTemplate=await u(this.commonService.getEmailTemplate("Membership-Registration")),this.form.patchValue({subject:this.emailTemplate.subject,htmlBody:this.emailTemplate.body}),await this.loadList("N")}catch(o){console.error("Initialization failed:",o)}finally{this.loadingService.setContentLoading(!1)}}async onFilterSubmit(){await this.loadList()}onRegionChange(){let o=+this.filterForm.value.regionId}async onCountryChange(o){let e=+o.target.value;this.subscriptionList=await u(this.commonService.getSubscriptions(e))}onSubscriptionChange(o){let e=+o.target.value,l=this.subscriptionList.find(m=>m.id===e);l&&this.form.patchValue({subscriptionId:e,durationUnit:l.durationUnit,duration:l.duration})}async onSubmit(){if(this.form.invalid)return;let o=this.form.getRawValue();if(o.durationUnit==="M"&&(o.duration<1||o.duration>36)||o.durationUnit==="Y"&&(o.duration<1||o.duration>3)){alert("Invalid duration value.");return}let e=await u(this.blockRadianceService.submitMembership(o));e.statusCode===200?(this.form.patchValue({personalEmailId:""}),alert("Success: "+e.message),this.mode="list",await this.loadList()):alert("Error: "+e.message)}async setMode(o,e){this.mode=o,o==="view"&&e&&(this.selectedDetails=await u(this.blockRadianceService.getMembershipDetails(e)))}async loadList(o="N"){let e="",l=0,m=50;o==="F"?e=this.buildFilter():e="N",this.PaginationDto=await u(this.blockRadianceService.getMembershipList(e,l,m)),this.listItem=this.PaginationDto.items,alert(`Data:
`+JSON.stringify(this.PaginationDto,null,2))}buildFilter(){let o=this.filterForm.value;return o.fromDate&&o.toDate?`${o.regionId},${o.countryId},${o.membershipId},${o.partnerCompanyName},${o.status},${o.source},${this.convertDate(o.fromDate)},${this.convertDate(o.toDate)}`:`${o.regionId},${o.countryId},${o.membershipId},${o.partnerCompanyName},${o.status},${o.source},0,0`}convertDate(o){let e=new Date(o);return`${e.getDate().toString().padStart(2,"0")}/${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getFullYear()}`}async DownloadExcelFile(){let o=this.buildFilter(),e=await u(this.blockRadianceService.downloadMembershipExcel(o)),l=document.createElement("a");l.href=URL.createObjectURL(e),l.download="Membership_List.xlsx",l.click()}static \u0275fac=function(e){return new(e||r)(E(Q),E(I),E(te),E(O))};static \u0275cmp=F({type:r,selectors:[["app-blockradiance"]],decls:9,vars:4,consts:[["regionSelect",""],["countrySelect",""],[1,"mb-3"],[1,"btn","btn-primary","me-2",3,"click"],[1,"btn","btn-success","me-2",3,"click"],["class","row g-3 mb-4",3,"formGroup","ngSubmit",4,"ngIf"],[4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],["class","card",4,"ngIf"],[1,"row","g-3","mb-4",3,"ngSubmit","formGroup"],[1,"col-md-3"],[4,"ngIf","ngIfElse"],["formControlName","partnerCompanyName",1,"form-control"],["formControlName","membershipId",1,"form-control"],["formControlName","status",1,"form-control"],["value",""],["value","P"],["value","S"],["value","A"],["value","D"],["formControlName","source",1,"form-control"],[1,"col-md-4"],[1,"d-flex","gap-2"],["type","date","formControlName","fromDate",1,"form-control"],[1,"align-self-center"],["type","date","formControlName","toDate",1,"form-control"],[1,"col-md-2","d-flex","align-items-end","gap-2"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-success",3,"click"],["disabled","",1,"form-control",3,"value"],["formControlName","regionId",1,"form-control",3,"change"],["value","0"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","countryId",1,"form-control"],[1,"table","table-bordered","table-striped"],[4,"ngFor","ngForOf"],[1,"text-end"],[1,"btn","btn-info","btn-sm",3,"click"],[3,"ngSubmit","formGroup"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"row","g-3"],["formControlName","countryId",1,"form-control",3,"change"],["formControlName","subscriptionId",1,"form-control",3,"change"],["formControlName","companyId",1,"form-control"],[1,"col-md-2"],["type","text","formControlName","durationUnit","readonly","",1,"form-control"],[1,"col-md-1"],["type","number","formControlName","duration","readonly","",1,"form-control"],[1,"col-md-12"],["formControlName","personalEmailId",1,"form-control"],["formControlName","subject",1,"form-control"],["formControlName","htmlBody",1,"form-control",2,"height","150px"],[1,"text-center","mt-3"],["type","submit",1,"btn","btn-success",3,"disabled"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"btn","btn-warning","btn-sm",3,"click"],[1,"card-body","row","g-3"],[1,"col-md-6"]],template:function(e,l){e&1&&(i(0,"div",2)(1,"button",3),f("click",function(){return l.setMode("list")}),n(2,"Membership List"),t(),i(3,"button",4),f("click",function(){return l.setMode("new")}),n(4,"New Membership"),t()(),b(5,se,52,5,"form",5)(6,pe,26,1,"div",6)(7,ve,46,5,"form",7)(8,ge,39,9,"div",8)),e&2&&(a(5),c("ngIf",l.mode==="list"),a(),c("ngIf",l.mode==="list"),a(),c("ngIf",l.mode==="new"),a(),c("ngIf",l.mode==="view"&&l.selectedDetails))},dependencies:[$,T,L,W,H,X,Z,j,q,J,G,K,ee,z,Y],encapsulation:2})};var Te=[{path:"",canActivateChild:[A],children:[{path:"BlockRadianceMembershipList",component:D}]}];export{Te as BLOCKRADIANCE_ROUTES};
